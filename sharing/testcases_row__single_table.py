import pytest
import mainfunction

# For a SINGLE TABLE: `Sample` table is used.
# For single column:

# Rule 1 filters rows based on a single column and all values of the rows.

rule_1 = [{
        "ruleID": "rule1",
        "table": "Sample",
        "variable": "fieldSampleTempC",
        "ruleValue": "ALL",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output1 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S100",
                        "shippedOnce": "Yes",
                        "siteID": "Site T100",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S101",
                        "shippedOnce": "Yes",
                        "siteID": "Site T101",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S102",
                        "shippedOnce": "Yes",
                        "siteID": "Site T102",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule1",
    },
]

def test_method_1():
  assert create_dataset(rule_1) == output1

# Rule 2 filters rows based on a single column and single value being numeric.

rule_2 = [{
        "ruleID": "rule2",
        "table": "Sample",
        "variable": "fieldSampleTempC",
        "ruleValue": 14.0,
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output2 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    }
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule2",
    },
]

def test_method_2():
  assert create_dataset(rule_2) == output2

#Rule 3 filters rows based on a single column and single value being string.

rule_3 = [{
        "ruleID": "rule3",
        "table": "Sample",
        "variable": "type",
        "ruleValue": "swrSed",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]


output3 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    }
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule3",
    },
]

def test_method_3():
  assert create_dataset(rule_3) == output3

#Rule 4 filters rows based on a single column and single value from each column or any of the columns being a datetime.

rule_4 = [{
        "ruleID": "rule4",
        "table": "Sample",
        "variable": "dateTimeStart",
        "ruleValue": "2021-01-30 8:00",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output4 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    }
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule4",
    },
]

def test_method_4():
  assert create_dataset(rule_4) == output4

#Rule 5 filters rows based on a single column and range interval for a numeric value with [] interval.

rule_5 = [{
        "ruleID": "rule5",
        "table": "Sample",
        "variable": "fieldSampleTempC",
        "ruleValue": "[12.0,13.0]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output5 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule5",
    },
]

def test_method_5():
  assert create_dataset(rule_5) == output5

#Rule 6 filters rows based on a single column and range interval for a numeric value with () interval.

rule_6 = [{
        "ruleID": "rule6",
        "table": "Sample",
        "variable": "fieldSampleTempC",
        "ruleValue": "(12.0,15.0)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output6 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule6",
    },
]

def test_method_6():
  assert create_dataset(rule_6) == output6

#Rule 7 filters rows based on a single column and range interval for a numeric value with (] interval.

rule_7 = [{
        "ruleID": "rule7",
        "table": "Sample",
        "variable": "fieldSampleTempC",
        "ruleValue": "(12.0,14.0]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output7 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule7",
    },
]

def test_method_7():
  assert create_dataset(rule_7) == output7

#Rule 8 filters rows based on a single column and range interval for a numeric value with [) interval.

rule_8 = [{
        "ruleID": "rule8",
        "table": "Sample",
        "variable": "fieldSampleTempC",
        "ruleValue": "[12.0,14.0)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output8 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule8",
    },
]

def test_method_8():
  assert create_dataset(rule_8) == output8

#Rule 9 filters rows based on a single column and range interval between datetime value with [] interval.

rule_9 = [{
        "ruleID": "rule9",
        "table": "Sample",
        "variable": "dateTimeStart",
        "ruleValue": "[2021-01-24 8:00,2021-01-28 8:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output9 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule9",
    },
]

def test_method_9():
  assert create_dataset(rule_9) == output9

#Rule 10 filters rows based on a single column and range interval between datetime value with () interval.

rule_10 = [{
        "ruleID": "rule10",
        "table": "Sample",
        "variable": "dateTimeStart",
        "ruleValue": "(2021-01-24 8:00,2021-01-30 8:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]
  
output10 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule10",
    },
]

def test_method_10():
  assert create_dataset(rule_10) == output10

#Rule 11 filters rows based on a single column and range interval between datetime value with (] interval.

rule_11 = [{
        "ruleID": "rule11",
        "table": "Sample",
        "variable": "dateTimeStart",
        "ruleValue": "(2021-01-24 8:00,2021-01-27 8:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output11 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule11",
    },
]

def test_method_11():
  assert create_dataset(rule_11) == output11

#Rule 12 filters rows based on a single column and range interval between datetime value with [) interval.

rule_12 = [{
        "ruleID": "rule12",
        "table": "Sample",
        "variable": "dateTimeStart",
        "ruleValue": "[2021-01-24 8:00,2021-01-27 8:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output12 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": np.nan,
                        "shippedOnce": "Yes",
                        "siteID": "Site T100",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": np.nan,
                        "shippedOnce": "Yes",
                        "siteID": "Site T101",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": np.nan,
                        "shippedOnce": "Yes",
                        "siteID": "Site T102",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": np.nan,
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": np.nan,
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": np.nan,
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": np.nan,
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": np.nan,
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": np.nan,
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S100",
                        "shippedOnce": "Yes",
                        "siteID": "Site T100",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S101",
                        "shippedOnce": "Yes",
                        "siteID": "Site T101",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S102",
                        "shippedOnce": "Yes",
                        "siteID": "Site T102",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule12",
    },
]

def test_method_12():
  assert create_dataset(rule_12) == output12

#Rule 13 filters rows based on a single column and range interval between two value with () interval where lower bound is infinity.

rule_13 = [{
        "ruleID": "rule13",
        "table": "Sample",
        "variable": "dateTimeStart",
        "ruleValue": "(Inf,2021-01-28 8:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output13 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule13",
    },
]

def test_method_13():
  assert create_dataset(rule_13) == output13

#Rule 14 filters rows based on a single column and range interval between two value with (] interval where lower bound is infinity.

rule_14 = [{
        "ruleID": "rule14",
        "table": "Sample",
        "variable": "dateTimeStart",
        "ruleValue": "(Inf,2021-01-30 8:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output14 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule14",
    },
]

def test_method_14():
  assert create_dataset(rule_14) == output14

#Rule 15 filters rows based on a single column and range interval between two value with () interval where upper bound is infinity.

rule_15 = [{
        "ruleID": "rule15",
        "table": "Sample",
        "variable": "dateTimeStart",
        "ruleValue": "(2021-02-01 21:00,Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output15 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S100",
                        "shippedOnce": "Yes",
                        "siteID": "Site T100",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S101",
                        "shippedOnce": "Yes",
                        "siteID": "Site T101",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S102",
                        "shippedOnce": "Yes",
                        "siteID": "Site T102",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule15",
    },
]

def test_method_15():
  assert create_dataset(rule_15) == output15

#Rule 16 filters rows based on a single column and range interval between two value with [) interval where upper bound is infinity.

rule_16 = [{
        "ruleID": "rule16",
        "table": "Sample",
        "variable": "dateTimeStart",
        "ruleValue": "[2021-02-02 21:00,Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output16 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule16",
    },
]

def test_method_16():
  assert create_dataset(rule_16) == output16

#Rule 17 filters rows based on a single column and multiple values to filter by a single value and a range.

rule_17 = [{
        "ruleID": "rule17",
        "table": "Sample",
        "variable": "fieldSampleTempC",
        "ruleValue": "12.0;(13.0,14.0]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output17 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule17",
    },
]

def test_method_17():
  assert create_dataset(rule_17) == output17

# For SINGLE TABLE:
## MULTIPLE COLUMNS:

#Rule 18 filters all rows from more than 1 column from a single table.

rule_18 = [{
        "ruleID": "rule18",
        "table": "Sample",
        "variable": "fieldSampleTempC;storageTempC",
        "ruleValue": "ALL",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output18 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S100",
                        "shippedOnce": "Yes",
                        "siteID": "Site T100",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S101",
                        "shippedOnce": "Yes",
                        "siteID": "Site T101",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S102",
                        "shippedOnce": "Yes",
                        "siteID": "Site T102",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule18",
    },
]

def test_method_18():
  assert create_dataset(rule_18) == output18

#Rule 19 filters rows from multiple columns from a single table based on a single value from each column or any of the columns being a number. 

rule_19 = [{
        "ruleID": "rule19",
        "table": "Sample",
        "variable": "fieldSampleTempC;storageTempC",
        "ruleValue": "12.0;22",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output19 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule19",
    },
]

def test_method_19():
  assert create_dataset(rule_19) == output19

#Rule 20 filters rows from multiple columns from a single table based on a single value from each columns or any of the columns being a string. 

rule_20 = [{
        "ruleID": "rule20",
        "table": "Sample",
        "variable": "type;collection",
        "ruleValue": "grb;pSludge",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]


output20 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule20",
    },
]

def test_method_20():
  assert create_dataset(rule_20) == output20

#Rule 21 filters rows from multiple columns from a single table based on a single value from each columns or any of the columns being a datetime. 

rule_21 = [{
        "ruleID": "rule21",
        "table": "Sample",
        "variable": "dateTimeStart;dateTimeEnd",
        "ruleValue": "2021-01-27 8:00",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output21 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    }
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule21",
    },
]

def test_method_21():
  assert create_dataset(rule_21) == output21

#Rule 22 filters rows from multiple columns from a single table based on a single value from each column or any of the columns being an 
# interval between two numbers with [] interval 

rule_22 = [{
        "ruleID": "rule22",
        "table": "Sample",
        "variable": "fieldSampleTempC;storageTempC",
        "ruleValue": "[16.0,18.0];[18,25]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output22 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule22",
    },
]

def test_method_22():
  assert create_dataset(rule_22) == output22

#Rule 23 filters rows from multiple columns from a single table based on a single value from each columns or any of the columns 
# being an interval between two numbers with () interval 

rule_23 = [{
        "ruleID": "rule23",
        "table": "Sample",
        "variable": "fieldSampleTempC;storageTempC",
        "ruleValue": "(16.0,18.0);(17,25)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]


output23 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule23",
    },
]

def test_method_23():
  assert create_dataset(rule_23) == output23   

#Rule 24 filters rows from multiple columns from a single table based on a single value from each columns or any of the columns 
# being an interval between two numbers with (] interval 

rule_24 = [{
        "ruleID": "rule24",
        "table": "Sample",
        "variable": "fieldSampleTempC;storageTempC",
        "ruleValue": "(15.0,18.0];(17,19]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output24 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule24",
    },
]

def test_method_24():
  assert create_dataset(rule_24) == output24

#Rule 25 filters rows from multiple columns from a single table based on a single value from each columns or any of the columns
# being an interval between two numbers with [) interval 

rule_25 = [{
        "ruleID": "rule25",
        "table": "Sample",
        "variable": "fieldSampleTempC;storageTempC",
        "ruleValue": "[16.0,18.0);[17,19)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output25 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule25",
    },
]

def test_method_25():
  assert create_dataset(rule_25) == output25

#Rule 26 filters rows from multiple columns from a single table based on a single value from each columns or any of the columns 
# being an interval between two datetime values with [] interval 

rule_26 = [{
        "ruleID": "rule26",
        "table": "Sample",
        "variable": "dateTimeStart;dateTimeEnd",
        "ruleValue": "[2021-01-25 8:00,2021-01-26 8:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output26 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule26",
    },
]

def test_method_26():
  assert create_dataset(rule_26) == output26

#Rule 27 filters rows from multiple columns from a single table based on a single value from each column or any of the columns
# being an interval between two datetime values with () interval 

rule_27 = [{
        "ruleID": "rule27",
        "table": "Sample",
        "variable": "dateTimeStart;dateTimeEnd",
        "ruleValue": "(2021-01-26 8:00,2021-01-30 8:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output27 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule27",
    },
]

def test_method_27():
  assert create_dataset(rule_27) == output27

#Rule 28 filters rows from multiple columns from a single table based on a single value from each column or any of the columns 
# being an interval between two datetime values with (] interval 

rule_28 = [{
        "ruleID": "rule28",
        "table": "Sample",
        "variable": "dateTimeStart;dateTimeEnd",
        "ruleValue": "(2021-01-26 8:00,2021-01-30 8:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output28 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule28",
    },
]

def test_method_28():
  assert create_dataset(rule_28) == output28

#Rule 29 filters rows from multiple columns from a single table based on a single value from each column or any of the columns 
# being an interval between two datetime values with [) interval 

rule_29 = [{
        "ruleID": "rule29",
        "table": "Sample",
        "variable": "dateTimeStart;dateTimeEnd",
        "ruleValue": "[2021-01-27 8:00,2021-01-30 8:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output29 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule29",
    },
]

def test_method_29():
  assert create_dataset(rule_29) == output29

#Rule 30 filters rows from multiple columns from a single table based on a single value from each column or any of the columns 
# being an interval between two values where the lower bound limit is infinity and with () interval

rule_30 = [{
        "ruleID": "rule30",
        "table": "Sample",
        "variable": "dateTimeStart;dateTimeEnd",
        "ruleValue": "(Inf,2021-01-30 8:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output30 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule30",
    },
]

def test_method_30():
  assert create_dataset(rule_30) == output30

#Rule 31 filters rows from multiple columns from a single table based on a single value from each column or any of the columns 
# being an interval between two values where the lower bound limit is infinity and with (] interval

rule_31 = [{
        "ruleID": "rule31",
        "table": "Sample",
        "variable": "dateTimeStart;dateTimeEnd",
        "ruleValue": "(Inf,2021-01-30 8:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output31 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule31",
    },
]

def test_method_31():
  assert create_dataset(rule_31) == output31

#Rule 32 filters rows from multiple columns from a single table based on a single value from each column or any of the columns 
# being an interval between two values where the upper bound limit is infinity and with () interval

rule_32 = [{
        "ruleID": "rule32",
        "table": "Sample",
        "variable": "dateTimeStart;dateTimeEnd",
        "ruleValue": "(2021-02-02 21:00,Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output32 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule32",
    },
]

def test_method_32():
  assert create_dataset(rule_32) == output32

#Rule 33 filters rows from multiple columns from a single table based on a single value from each column or any of the columns 
# being an interval between two values where the upper bound limit is infinity and with [) interval

rule_33 = [{
        "ruleID": "rule33",
        "table": "Sample",
        "variable": "dateTimeStart;dateTimeEnd",
        "ruleValue": "[2021-02-03 21:00,Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output33 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule33",
    },
]

def test_method_33():
  assert create_dataset(rule_33) == output33

#Rule 34 filters rows from multiple columns from a single table based on multiple values where one can be a single value 
# and other being an interval. 

rule_34 = [{
        "ruleID": "rule34",
        "table": "Sample",
        "variable": "type;dateTimeStart;dateTimeEnd;storageTempC",
        "ruleValue": "swrSed;[2021-01-25 8:00,2021-01-30 8:00);[17,20]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output34 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule34",
    }
]

def test_method_34():
  assert create_dataset(rule_34) == output34

#SINGLE TABLE:
# ALL COLUMNS:

#Rule 35 filters all the rows from all column from a single table.

rule_35 = [{
        "ruleID": "rule35",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "ALL",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output35 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S100",
                        "shippedOnce": "Yes",
                        "siteID": "Site T100",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S101",
                        "shippedOnce": "Yes",
                        "siteID": "Site T101",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S102",
                        "shippedOnce": "Yes",
                        "siteID": "Site T102",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule35",
    },
]

def test_method_35():
  assert create_dataset(rule_35) == output35

#Rule 36 filters rows from all columns from a single table based on a single value from each column or any of the columns being a number.

rule_36 = [{
        "ruleID": "rule36",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "10.0;25;13.0",
        "direction": "row",
        "sharedWith": "PHAC"
    }]

output36 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule36",
    },
]

def test_method_36():
  assert create_dataset(rule_36) == output36

#Rule 37 filters rows from all columns from a single table based on a single value from each column or any of the columns being a string.

rule_37 = [{
        "ruleID": "rule37",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "Site T113;mooreSw;pSludge;",
        "direction": "row",
        "sharedWith": "PHAC"
    }]

output37 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule37",
    },
]

def test_method_37():
  assert create_dataset(rule_37) == output37

#Rule 38 filters rows from all columns from a single table based on a single value from each column or any of the columns being a datetime.

rule_38 = [{
        "ruleID": "rule38",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "2021-02-27 21:00;2021-01-30 8:00",
        "direction": "row",
        "sharedWith": "Public"
    }]

output38 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule38",
    },
]

def test_method_38():
  assert create_dataset(rule_38) == output38

#Rule 39 filters rows from all columns from a single table based on a single value from each column or any of the columns being an 
# interval between two numbers with [] interval.

rule_39 = [{
        "ruleID": "rule39_1",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "[8.0,10.0]",
        "direction": "row",
        "sharedWith": "PHAC"
    },{
        "ruleID": "rule39_2",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "[16.0,18.0]",
        "direction": "row",
        "sharedWith": "PHAC"}
]

output39 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            }
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule39_1",
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S100",
                        "shippedOnce": "Yes",
                        "siteID": "Site T100",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S101",
                        "shippedOnce": "Yes",
                        "siteID": "Site T101",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S102",
                        "shippedOnce": "Yes",
                        "siteID": "Site T102",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule39_2",
    },
]

def test_method_39():
  assert create_dataset(rule_39) == output39

#Rule 40 filters rows from all columns from a single table based on a single value from each column or any of the columns 
# being an interval between two numbers with () interval.

rule_40 = [{
        "ruleID": "rule40",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "(2.0,10.0);(17,22);(12,15)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output40 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule40",
    },
]

def test_method_40():
  assert create_dataset(rule_40) == output40

#Rule 41 filters rows from all columns from a single table based on a single value from each column or any of the columns
# being an interval between two numbers with (] interval.

rule_41 = [{
        "ruleID": "rule41",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "(2.0,10.0];(16,25];(12,14]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]


output41 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule41",
    },
]

def test_method_41():
  assert create_dataset(rule_41) == output41

#Rule 42 filters rows from all columns from a single table based on a single value from each column or any of the columns
# being an interval between two numbers with [) interval.

rule_42 = [{
        "ruleID": "rule42",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "[3.0,10.0);[22,25);[12,15)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]


output42 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule42",
    },
]

def test_method_42():
  assert create_dataset(rule_42) == output42

#Rule 43 filters rows from all columns from a single table based on a single value from each column or any of the columns
# being an interval between two datetime values with [] interval.

rule_43 = [{
        "ruleID": "rule43",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "[2021-01-25 8:00,2021-01-30 8:00];[2021-01-29 21:00,2021-01-31 21:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output43 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule43",
    },
]

def test_method_43():
  assert create_dataset(rule_43) == output43

#Rule 44 filters rows from all columns from a single table based on a single value from each column or any of the columns
# being an interval between two datetime values with () interval.

rule_44 = [{
        "ruleID": "rule44",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "(2021-01-25 8:00,2021-01-30 8:00);(2021-01-29 21:00,2021-02-01 21:00)",
        "direction": "row",
        "sharedWith": "PHAC"
    }]

output44 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule44",
    },
]

def test_method_44():
  assert create_dataset(rule_44) == output44

#Rule 45 filters rows from all columns from a single table based on a single value from each column or any of the columns
# being an interval between two datetime values with (] interval.

rule_45 = [{
        "ruleID": "rule45",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "(2021-01-25 8:00,2021-01-30 8:00];(2021-01-29 21:00,2021-02-01 21:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output45 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            }
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S100",
                        "shippedOnce": "Yes",
                        "siteID": "Site T100",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S101",
                        "shippedOnce": "Yes",
                        "siteID": "Site T101",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S102",
                        "shippedOnce": "Yes",
                        "siteID": "Site T102",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule45",
    },
]

def test_method_45():
  assert create_dataset(rule_45) == output45

#Rule 46 filters rows from all columns from a single table based on a single value from each column or any of the columns
# being an interval between two datetime values with [) interval.

rule_46 = [{
        "ruleID": "rule46",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "[2021-02-01 21:00,2021-02-04 21:00);[2021-01-29 21:00,2021-02-01 21:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output46 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S100",
                        "shippedOnce": "Yes",
                        "siteID": "Site T100",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S101",
                        "shippedOnce": "Yes",
                        "siteID": "Site T101",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S102",
                        "shippedOnce": "Yes",
                        "siteID": "Site T102",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule46",
    },
]

def test_method_46():
  assert create_dataset(rule_46) == output46

#Rule 47 filters rows from all columns from a single table based on a single value 
# being an interval where the lower bound limit is infinity with (] interval

rule_47 = [{
        "ruleID": "rule47",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "(Inf,2021-01-26 8:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output47 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule47",
    },
]

def test_method_47():
  assert create_dataset(rule_47) == output47

#Rule 48 filters rows from all columns from a single table based on a single value
# being an interval where the lower bound limit is infinity with () interval

rule_48 = [{
        "ruleID": "rule48",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "(Inf,2021-01-28 8:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]


output48 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule48",
    },
]

def test_method_48():
  assert create_dataset(rule_48) == output48

#Rule 49 filters rows from all columns from a single table based on a single value 
# being an interval where the upper bound limit is infinity with () interval

rule_49 = [{
        "ruleID": "rule49",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "(16,Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output49 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule49",
    },
]

def test_method_49():
  assert create_dataset(rule_49) == output49

#Rule 50 filters rows from all columns from a single table based on a single value being an interval 
# where the upper bound limit is infinity with [) interval

rule_50 = [{
        "ruleID": "rule50",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "[19,Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output50 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule50",
    },
]

def test_method_50():
  assert create_dataset(rule_50) == output50

#Rule 51 filters rows from all columns from a single table based on a multiple values where one can be an interval and other a value.

rule_51 = [{
        "ruleID": "rule51",
        "table": "Sample",
        "variable": "ALL",
        "ruleValue": "[19,25];(17,22);(2021-02-01 21:00,2021-02-04 21:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output51 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule51",
    },
]

def test_method_51():
  assert create_dataset(rule_51) == output51