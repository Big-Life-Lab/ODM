import pytest
import mainfunction

#FOR ALL TABLES: INCLUDING SAMPLE, WWMEASURE AND ASSAYMETHOD TABLE.
## FOR SINGLE COLUMN FROM EACH TABLE OR ANY OF THE TABLE

# Rule 103 filters rows based on a single column and all values of the rows.

rule_103 = [{
        "ruleID": "rule103",
        "table": "ALL",
        "variable": "fieldSampleTempC;unitOther",
        "ruleValue": "ALL",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output103 = [
    {"AssayMethod": [], "Sample": [], "WWMeasure": []},
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule103",
    },
]

def test_method_103():
  assert create_dataset(rule_103) == output103

# Rule 104 filters rows based on a single column from each table and single value from each column or any of the columns being numeric.

rule_104 = [{
        "ruleID": "rule104",
        "table": "ALL",
        "variable": "value;fieldSampleTempC;sampleSizeL",
        "ruleValue": "17.0;92000;0.002",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output104 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 22,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 22,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    }
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule104",
    },
]

def test_method_104():
  assert create_dataset(rule_104) == output104

# Rule 105 filters rows based on a single column from each table and single value from each column or any of the columns being string.

rule_105 = [{
        "ruleID": "rule105",
        "table": "ALL",
        "variable": "unitOther;collection",
        "ruleValue": "mooreSW;gcMcovN2",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output105 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 22,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 22,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule105",
    },
]

def test_method_105():
  assert create_dataset(rule_105) == output105

# Rule 106 filters rows based on a single column from each table and single value from each column or any of the columns being datetime.

rule_106 = [{
        "ruleID": "rule106",
        "table": "ALL",
        "variable": "analysisDate;dateTimeStart;date",
        "ruleValue": "2021-02-02;2021-02-01 21:00",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output106 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 22,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 22,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    }
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule106",
    },
]

def test_method_106():
  assert create_dataset(rule_106) == output106

# Rule 107 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two numeric values with [].

rule_107 = [{
        "ruleID": "rule107",
        "table": "ALL",
        "variable": "fieldSampleTempC;value",
        "ruleValue": "[89000,98000];[16.0,18.0]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output107 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule107",
    },
]

def test_method_107():
  assert create_dataset(rule_107) == output107

# Rule 108 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two numeric values with ().

rule_108 = [{
        "ruleID": "rule108",
        "table": "ALL",
        "variable": "fieldSampleTempC;value;sampleSizeL",
        "ruleValue": "(89000,145000);(15.0,18.0); (0.001;0.003)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output108 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule108",
    },
]

def test_method_108():
  assert create_dataset(rule_108) == output108

# Rule 109 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two numeric values with (].

rule_109 = [{
        "ruleID": "rule109",
        "table": "ALL",
        "variable": "fieldSampleTempC;value;sampleSizeL",
        "ruleValue": "(89000,145000];(15.0,18.0]; (0.001;0.003]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output109 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule109",
    },
]

def test_method_109():
  assert create_dataset(rule_109) == output109

# Rule 110 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two numeric values with [).

rule_110 = [{
        "ruleID": "rule110",
        "table": "ALL",
        "variable": "fieldSampleTempC;value;sampleSizeL",
        "ruleValue": "[89000,98000);[16.0,18.0); [0.002;0.003)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output110 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule110",
    },
]

def test_method_110():
  assert create_dataset(rule_110) == output110

# Rule 111 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two datetime values with [].

rule_111 = [{
        "ruleID": "rule111",
        "table": "ALL",
        "variable": "dateTimeStart;analysisDate;date",
        "ruleValue": "[2021-01-31,2021-02-02]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output111 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 22,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 22,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule111",
    },
]

def test_method_111():
  assert create_dataset(rule_111) == output111

# Rule 112 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two datetime values with ().

rule_112 = [{
        "ruleID": "rule112",
        "table": "ALL",
        "variable": "dateTimeStart;analysisDate;date",
        "ruleValue": "(2021-01-25 8:00,2021-01-31 8:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output112 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule112",
    },
]

def test_method_112():
  assert create_dataset(rule_112) == output112

# Rule 113 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two datetime values with (].

rule_113 = [{
        "ruleID": "rule113",
        "table": "ALL",
        "variable": "dateTimeStart;analysisDate;date",
        "ruleValue": "(2021-01-29,2021-02-02]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output113 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 22,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 22,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule113",
    },
]

def test_method_113():
  assert create_dataset(rule_113) == output113

# Rule 114 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two datetime values with [).

rule_114 = [{
        "ruleID": "rule114",
        "table": "ALL",
        "variable": "dateTimeStart;analysisDate;date",
        "ruleValue": "[2021-01-25 8:00,2021-02-01 21:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output114 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "assayMethodID.1": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10.0,
                "loq": 30.0,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "assayMethodID.1": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10.0,
                "loq": 30.0,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "assayMethodID.1": np.nan,
                "date": NaT,
                "instrumentID": np.nan,
                "lod": np.nan,
                "loq": np.nan,
                "name": np.nan,
                "referenceLink": np.nan,
                "sampleSizeL": np.nan,
                "summary": np.nan,
                "unit": np.nan,
                "unitOther": np.nan,
                "version": np.nan,
            },
            {
                "assayMethodID": "Assay Y103",
                "assayMethodID.1": np.nan,
                "date": NaT,
                "instrumentID": np.nan,
                "lod": np.nan,
                "loq": np.nan,
                "name": np.nan,
                "referenceLink": np.nan,
                "sampleSizeL": np.nan,
                "summary": np.nan,
                "unit": np.nan,
                "unitOther": np.nan,
                "version": np.nan,
            },
            {
                "assayMethodID": "Assay Y104",
                "assayMethodID.1": np.nan,
                "date": NaT,
                "instrumentID": np.nan,
                "lod": np.nan,
                "loq": np.nan,
                "name": np.nan,
                "referenceLink": np.nan,
                "sampleSizeL": np.nan,
                "summary": np.nan,
                "unit": np.nan,
                "unitOther": np.nan,
                "version": np.nan,
            },
            {
                "assayMethodID": "Assay Y105",
                "assayMethodID.1": np.nan,
                "date": NaT,
                "instrumentID": np.nan,
                "lod": np.nan,
                "loq": np.nan,
                "name": np.nan,
                "referenceLink": np.nan,
                "sampleSizeL": np.nan,
                "summary": np.nan,
                "unit": np.nan,
                "unitOther": np.nan,
                "version": np.nan,
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule114",
    },
]

def test_method_114():
  assert create_dataset(rule_114) == output114

# Rule 115 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two values where the lower bound limit is infinity with ().

rule_115 = [{
        "ruleID": "rule115",
        "table": "ALL",
        "variable": "storageTempC;analysisDate;date",
        "ruleValue": "(Inf,17)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output115 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 22,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 22,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 22,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 22,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 22,
                        "type": "swrSed",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S100",
                        "shippedOnce": "Yes",
                        "siteID": "Site T100",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S101",
                        "shippedOnce": "Yes",
                        "siteID": "Site T101",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S102",
                        "shippedOnce": "Yes",
                        "siteID": "Site T102",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule115",
    },
]

def test_method_115():
  assert create_dataset(rule_115) == output115

# Rule 116 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two values where the lower bound limit is infinity with (].

rule_116 = [{
        "ruleID": "rule116",
        "table": "ALL",
        "variable": "fieldSampleTempC;analysisDate;date",
        "ruleValue": "(Inf,17]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output116 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S100",
                        "shippedOnce": "Yes",
                        "siteID": "Site T100",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S101",
                        "shippedOnce": "Yes",
                        "siteID": "Site T101",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S102",
                        "shippedOnce": "Yes",
                        "siteID": "Site T102",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule116",
    },
]

def test_method_116():
  assert create_dataset(rule_116) == output116

# Rule 117 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two values where the upper bound limit is infinity with ().

rule_117 = [{
        "ruleID": "rule117",
        "table": "ALL",
        "variable": "storageTempC;analysisDate;date",
        "ruleValue": "(2021-01-30,Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output117 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 22,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 22,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule117",
    },
]

def test_method_117():
  assert create_dataset(rule_117) == output117

# Rule 118 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two values where the upper bound limit is infinity with [).

rule_118 = [{
        "ruleID": "rule118",
        "table": "ALL",
        "variable": "storageTempC;analysisDate;date",
        "ruleValue": "[2021-01-30,Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output118 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 22,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 22,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule118",
    },
]

def test_method_118():
  assert create_dataset(rule_118) == output118

# Rule 119 filters rows based on a single column from each table and multiple values from each column or any of the columns where one value could be
# an interval and other a single value.

rule_119 = [{
        "ruleID": "rule119",
        "table": "ALL",
        "variable": "analysisDate;date;fieldSampleTempC",
        "ruleValue": "[2021-01-31,2021-02-09]; 17.0",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output119 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 22,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 22,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule119",
    },
]

def test_method_119():
  assert create_dataset(rule_119) == output119

# For ALL TABLES:
## MULTIPLE COLUMNS FROM EACH TABLE OR ANY OF THE TABLES

# Rule 120 filters rows based on multiple columns and all values of the rows.

rule_120 = [{
        "ruleID": "rule120",
        "table": "ALL",
        "variable": "type;dateTimeStart;analysisDate;date;unitOther",
        "ruleValue": "ALL",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output120 = [
    {"AssayMethod": [], "Sample": [], "WWMeasure": []},
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule120",
    },
]

def test_method_120():
  assert create_dataset(rule_120) == output120

# Rule 121 filters rows based on multiple columns from each table and single value from each column or any of the columns being numeric.

rule_121 = [{
        "ruleID": "rule121",
        "table": "ALL",
        "variable": "value;storageTempC;fieldSampleTempC;sampleSizeL; index",
        "ruleValue": "16.0;98000; 0.003;6",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output121 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule121",
    },
]

def test_method_121():
  assert create_dataset(rule_121) == output121

# Rule 122 filters rows based on multiple columns from each table and single value from each column or any of the columns being string.

rule_122 = [{
        "ruleID": "rule122",
        "table": "ALL",
        "variable": "unitOther; type; collection",
        "ruleValue": "water; cpTP24h; gcmnPMMoV",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output122 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule122",
    },
]

def test_method_122():
  assert create_dataset(rule_122) == output122

# Rule 123 filters rows based on multiple columns from each table and single value from each column or any of the columns being datetime.

rule_123 = [{
        "ruleID": "rule123",
        "table": "ALL",
        "variable": "analysisDate; reportDate; date;dateTimeStart;dateTimeEnd",
        "ruleValue": "2021-02-02;2021-02-03 21:00",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output123 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 22,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 22,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule123",
    },
]

def test_method_123():
  assert create_dataset(rule_123) == output123

# Rule 124 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# numbers with [].

rule_124 = [{
        "ruleID": "rule124",
        "table": "ALL",
        "variable": "value;storageTempC;fieldSampleTempC;index;sampleSizeL",
        "ruleValue": "[16.0; 17.0]; [98000,145000];[0.002,0.003];[5,6]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output124 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule124",
    },
]

def test_method_124():
  assert create_dataset(rule_124) == output124

# Rule 125 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# numbers with ().

rule_125 = [{
        "ruleID": "rule125",
        "table": "ALL",
        "variable": "value;storageTempC;fieldSampleTempC;index;sampleSizeL",
        "ruleValue": "(15.0; 18.0); (98000,145000);(0.001,0.003);(4,6)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output125 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule125",
    },
]

def test_method_125():
  assert create_dataset(rule_125) == output125

# Rule 126 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# numbers with (].

rule_126 = [{
        "ruleID": "rule126",
        "table": "ALL",
        "variable": "value;storageTempC;fieldSampleTempC;index;sampleSizeL",
        "ruleValue": "(15.0; 18.0]; (89000,145000];(0.001,0.003];(4,6]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output126 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule126",
    },
]

def test_method_126():
  assert create_dataset(rule_126) == output126

# Rule 127 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# numbers with [).

rule_127 = [{
        "ruleID": "rule127",
        "table": "ALL",
        "variable": "value;storageTempC;fieldSampleTempC;index;sampleSizeL",
        "ruleValue": "[16.0; 18.0); [89000,145000);[0.002,0.003);[5,6)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output127 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule127",
    },
]

def test_method_127():
  assert create_dataset(rule_127) == output127

# Rule 128 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# datetime values with [].

rule_128 = [{
        "ruleID": "rule128",
        "table": "ALL",
        "variable": "dateTimeStart;dateTimeEnd;analysisDate;reportDate;date",
        "ruleValue": "[2021-02-01 21:00, 2021-02-03 21:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC",
    }]

output128 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 22,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 22,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule128",
    },
]

def test_method_128():
  assert create_dataset(rule_128) == output128

# Rule 129 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# datetime values with ().

rule_129 = [{
        "ruleID": "rule129",
        "table": "ALL",
        "variable": "dateTimeStart;dateTimeEnd;analysisDate;reportDate;date",
        "ruleValue": "(2021-01-29,2021-02-06)",
        "direction": "row",
        "sharedWith": "Public;PHAC",
    }]


output129 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 22,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 22,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule129",
    },
]

def test_method_129():
  assert create_dataset(rule_129) == output129

# Rule 130 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# datetime values with (].

rule_130 = [{
        "ruleID": "rule130",
        "table": "ALL",
        "variable": "dateTimeStart;dateTimeEnd;analysisDate;reportDate;date",
        "ruleValue": "(2021-01-30 8:00, 2021-02-03 21:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output130 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 22,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 22,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule130",
    },
]

def test_method_130():
  assert create_dataset(rule_130) == output130

# Rule 131 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# datetime values with [).

rule_131 = [{
        "ruleID": "rule131",
        "table": "ALL",
        "variable": "dateTimeStart;dateTimeEnd;analysisDate;reportDate;date",
        "ruleValue": "[2021-01-30,2021-02-06)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output131 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 22,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 22,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule131",
    },
]

def test_method_131():
  assert create_dataset(rule_131) == output131


# Rule 132 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval where the 
# the lower bound limit is infinity with ().

rule_132 = [{
        "ruleID": "rule132",
        "table": "ALL",
        "variable": "dateTimeStart;dateTimeEnd;analysisDate;date",
        "ruleValue": "(Inf, 2021-01-30)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output132 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 22,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule132",
    },
]

def test_method_132():
  assert create_dataset(rule_132) == output132

# Rule 133 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval where the 
# the lower bound limit is infinity with (].

rule_133 = [{
        "ruleID": "rule133",
        "table": "ALL",
        "variable": "dateTimeStart;dateTimeEnd;analysisDate;date",
        "ruleValue": "(Inf, 2021-01-30]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output133 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule133",
    },
]

def test_method_133():
  assert create_dataset(rule_133) == output133

# Rule 134 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval where the 
# the upper bound limit is infinity with ().

rule_134 = [{
        "ruleID": "rule134",
        "table": "ALL",
        "variable": "fieldSampleTempC;storageTempC;index",
        "ruleValue": "(16.0,Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output134 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule134",
    },
]

def test_method_134():
  assert create_dataset(rule_134) == output134

# Rule 135 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval where the 
# the upper bound limit is infinity with [).

rule_135 = [{
        "ruleID": "rule135",
        "table": "ALL",
        "variable": "fieldSampleTempC;storageTempC;index",
        "ruleValue": "[16.0,Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output135 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S100",
                        "shippedOnce": "Yes",
                        "siteID": "Site T100",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S101",
                        "shippedOnce": "Yes",
                        "siteID": "Site T101",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S102",
                        "shippedOnce": "Yes",
                        "siteID": "Site T102",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule135",
    },
]

def test_method_135():
  assert create_dataset(rule_135) == output135

# Rule 136 filters rows based on multiple columns from each table and multiple values from each column or any of the columns where one value could be an interval
# and the other could be a single value.

rule_136 = [{
        "ruleID": "rule136",
        "table": "ALL",
        "variable": "dateTimeStart;value;analysisDate;sampleSizeL;date",
        "ruleValue": "( 2021-01-30 8:00 , 2021-02-01 21:00] ; 145000;(2021-01-29, 2021-02-08]; [98000,145000],0.003",
        "direction": "row",
        "sharedWith": "Public;PHAC" 
    }]


output136 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule136",
    },
]

def test_method_136():
  assert create_dataset(rule_136) == output136

# For ALL TABLES:
## ALL COLUMNS FROM EACH TABLE OR ANY OF THE TABLES

# Rule 137 filters rows based on all columns from each table and all values of the rows.

rule_137 = [{
        "ruleID": "rule137",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "ALL",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output137 = [
    {"AssayMethod": [], "Sample": [], "WWMeasure": []},
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule137",
    },
]

def test_method_137():
  assert create_dataset(rule_137) == output137

# Rule 138 filters rows based on all columns from each table and single value from each column or any of the columns being numeric.

rule_138 = [{
        "ruleID": "rule138",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "17.0;98000;0.003;6",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output138 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule138",
    },
]

def test_method_138():
  assert create_dataset(rule_138) == output138

# Rule 139 filters rows based on all columns from each table and single value from each column or any of the columns being string.

rule_139 = [{
        "ruleID": "rule139",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "mooreSw;gcMcovN2",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output139 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule139",
    },
]

def test_method_139():
  assert create_dataset(rule_139) == output139

# Rule 140 filters rows based on all columns from each table and single value from each column or any of the columns being datetime.

rule_140 = [{
        "ruleID": "rule140",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "2021-01-28 8:00;2021-02-02",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output140 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule140",
    },
]

def test_method_140():
  assert create_dataset(rule_140) == output140

# Rule 141 filters rows based on all columns from each table and single value from each column or any of the columns being an interval 
# between two numbers with [].

rule_141 = [{
        "ruleID": "rule141",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "[8.0,10.0];[16.0,17.0],[76000,102000]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output141 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule141",
    },
]

def test_method_141():
  assert create_dataset(rule_141) == output141    

# Rule 142 filters rows based on all columns from each table and single value from each column or any of the columns being an interval 
# between two numbers with ().

rule_142 = [{
        "ruleID": "rule142",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "(2.0,10.0);(15.0,18.0),(92000,102000)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output142 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    }
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule142",
    },
]

def test_method_142():
  assert create_dataset(rule_142) == output142

# Rule 143 filters rows based on all columns from each table and single value from each column or any of the columns being an interval 
# between two numbers with (].

rule_143 = [{
        "ruleID": "rule143",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "(2.0,10.0];(15.0,18.0],(92000,102000]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output143 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule143",
    },
]

def test_method_143():
  assert create_dataset(rule_143) == output143

# Rule 144 filters rows based on all columns from each table and single value from each column or any of the columns being an interval 
# between two numbers with [).

rule_144 = [{
        "ruleID": "rule144",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "[3.0,10.0);[16.0,18.0),[92000,102000)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output144 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule144",
    },
]

def test_method_144():
  assert create_dataset(rule_144) == output144

# Rule 145 filters rows based on all columns from each table and single value from each column or any of the columns being an interval between two datetime
# with [].

rule_145 = [{
        "ruleID": "rule145",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "[2021-01-31,2021-02-06]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output145 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule145",
    },
]

def test_method_145():
  assert create_dataset(rule_145) == output145

# Rule 146 filters rows based on all columns from each table and single value from each column or any of the columns being an interval 
# between two datetime with ().

rule_146 = [{
        "ruleID": "rule146",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "(2021-01-27 8:00, 2021-01-30 8:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output146 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule146",
    },
]

def test_method_146():
  assert create_dataset(rule_146) == output146

# Rule 147 filters rows based on all columns from each table and single value from each column or any of the columns being an interval 
# between two datetime with (].

rule_147 = [{
        "ruleID": "rule147",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "(2021-01-31,2021-02-09]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output147 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule147",
    },
]

def test_method_147():
  assert create_dataset(rule_147) == output147

# Rule 148 filters rows based on all columns from each table and single value from each column or any of the columns being an interval 
# between two datetime with [).

rule_148 = [{
        "ruleID": "rule148",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "[2021-01-31,2021-02-09)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output148 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule148",
    },
]

def test_method_148():
  assert create_dataset(rule_148) == output148

# Rule 149 filters rows based on all columns from each table and single value from each column or any of the columns being an interval where the 
# the lower bound limit is infinity with ().

rule_149 = [{
        "ruleID": "rule149",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "(Inf, 2021-01-30)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output149 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule149",
    },
]


def test_method_149():
  assert create_dataset(rule_149) == output149

# Rule 150 filters rows based on all columns from each table and single value from each column or any of the columns being an interval where the 
# the lower bound limit is infinity with (].

rule_150 = [{
        "ruleID": "rule150",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "(Inf, 2021-01-30]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output150 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule150",
    },
]

def test_method_150():
  assert create_dataset(rule_150) == output150

# Rule 151 filters rows based on all columns from each table and single value from each column or any of the columns being an interval where the 
# the upper bound limit is infinity with ().

rule_151 = [{
        "ruleID": "rule151",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "(98000,Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output151 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            }
        ],
        "rule_id": "rule151",
    },
]

def test_method_151():
  assert create_dataset(rule_151) == output151

# Rule 152 filters rows based on all columns from each table and single value from each column or any of the columns being an interval where the 
# the upper bound limit is infinity with [).

rule_152 = [{
        "ruleID": "rule152",
        "table": "ALL",
        "variable": "ALL",
        "ruleValue": "[98000,Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]


output152 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            }
        ],
        "rule_id": "rule152",
    },
]

def test_method_152():
  assert create_dataset(rule_152) == output152

# Rule 153 filters rows based on all columns from each table and multiple values from each column or any of the columns where one value could be an interval
# and the other could be a single value.

rule_153 = [{
        "ruleID": "rule153",
        "table": "ALL",
        "variable": "dateTimeStart;value;analysisDate",
        "ruleValue": "( 2021-01-30 8:00 , 2021-02-03 21:00] ; 145000; [98000,145000]; 2021-03-06;swrSed",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output153 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule153",
    },
]

def test_method_153():
  assert create_dataset(rule_153) == output153