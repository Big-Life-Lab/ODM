import pytest
import mainfunction


#FOR MULTIPLE TABLES: Tables `Sample` and `WWMeasure` are used.
## FOR SINGLE COLUMN FROM EACH TABLE OR ANY OF THE TABLE

# Rule 52 filters rows based on a single column and all values of the rows.

rule_52 = [{
        "ruleID": "rule52",
        "table": "Sample;WWMeasure",
        "variable": "fieldSampleTempC;value",
        "ruleValue": "ALL",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output52 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [],
        "WWMeasure": [],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule52",
    },
]


def test_method_52():
  assert create_dataset(rule_52) == output52

# Rule 53 filters rows based on a single column from each table and single value from each column or any of the columns being numeric.

rule_53 = [{
        "ruleID": "rule53",
        "table": "Sample;WWMeasure",
        "variable": "value;fieldSampleTempC",
        "ruleValue": "16.0;98000",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output53 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    }
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule53",
    },
]

def test_method_53():
  assert create_dataset(rule_53) == output53

# Rule 54 filters rows based on a single column from each table and single value from each column or any of the columns being string.

rule_54 = [{
        "ruleID": "rule54",
        "table": "Sample;WWMeasure",
        "variable": "unitOther;type",
        "ruleValue": "gcmcovN1;water",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output54 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule54",
    },
]

def test_method_54():
  assert create_dataset(rule_54) == output54

# Rule 55 filters rows based on a single column from each table and single value from each column or any of the columns being datetime.

rule_55 = [{
        "ruleID": "rule55",
        "table": "Sample;WWMeasure",
        "variable": "dateTimeStart;analysisDate",
        "ruleValue": "2021-02-02 21:00;2021-02-08",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output55 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule55",
    },
]

def test_method_55():
  assert create_dataset(rule_55) == output55

# Rule 56 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two numeric values with [].

rule_56 = [{
        "ruleID": "rule56",
        "table": "Sample;WWMeasure",
        "variable": "fieldSampleTempC;value",
        "ruleValue": "[72000,98000];[16.0,17.0]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output56 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule56",
    },
]

def test_method_56():
  assert create_dataset(rule_56) == output56

# Rule 57 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two numeric values with ().

rule_57 = [{
        "ruleID": "rule57",
        "table": "Sample;WWMeasure",
        "variable": "fieldSampleTempC;value",
        "ruleValue": "(85000,145000);(15.0,17.0)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]


output57 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule57",
    },
]

def test_method_57():
  assert create_dataset(rule_57) == output57

# Rule 58 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two numeric values with (].

rule_58 = [{
        "ruleID": "rule58",
        "table": "Sample;WWMeasure",
        "variable": "fieldSampleTempC;value",
        "ruleValue": "(85000,145000];(15.0,17.0]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]


output58 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule58",
    },
]

def test_method_58():
  assert create_dataset(rule_58) == output58

# Rule 59 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two numeric values with [).

rule_59 = [{
        "ruleID": "rule59",
        "table": "Sample;WWMeasure",
        "variable": "fieldSampleTempC;value",
        "ruleValue": "[76000,145000);[16.0,17.0)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output59 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule59",
    },
]

def test_method_59():
  assert create_dataset(rule_59) == output59

# Rule 60 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two datetime values with [].

rule_60 = [{
        "ruleID": "rule60",
        "table": "Sample;WWMeasure",
        "variable": "analysisDate;dateTimeStart",
        "ruleValue": "[2021-01-24 8:00 , 2021-01-30 8:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output60 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule60",
    },
]

def test_method_60():
  assert create_dataset(rule_60) == output60

# Rule 61 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two datetime values with ().

rule_61 = [{
        "ruleID": "rule61",
        "table": "Sample;WWMeasure",
        "variable": "analysisDate;dateTimeStart",
        "ruleValue": "(2021-01-24 8:00,2021-02-01 21:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output61 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule61",
    },
]

def test_method_61():
  assert create_dataset(rule_61) == output61

# Rule 62 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two datetime values with (].

rule_62 = [{
        "ruleID": "rule62",
        "table": "Sample;WWMeasure",
        "variable": "analysisDate;dateTimeStart",
        "ruleValue": "(2021-01-29 8:00,2021-02-01 21:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output62 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    }
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule62",
    },
]

def test_method_62():
  assert create_dataset(rule_62) == output62

# Rule 63 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two datetime values with [).

rule_63 = [{
        "ruleID": "rule63",
        "table": "Sample;WWMeasure",
        "variable": "analysisDate;dateTimeStart",
        "ruleValue": "[2021-01-27,2021-02-02)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output63 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule63",
    },
]

def test_method_63():
  assert create_dataset(rule_63) == output63

# Rule 64 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two values where the lower bound limit is infinity with ().

rule_64 = [{
        "ruleID": "rule64",
        "table": "Sample;WWMeasure",
        "variable": "value;dateTimeStart",
        "ruleValue": "(Inf,2021-01-30 8:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output64 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-25 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S106",
                        "shippedOnce": "Yes",
                        "siteID": "Site T106",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S108",
                        "shippedOnce": "Yes",
                        "siteID": "Site T108",
                        "sizeL": 2,
                        "storageTempC": 18,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "mooreSw",
                        "dateTime": Timestamp("2021-02-27 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 12,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S111",
                        "shippedOnce": "Yes",
                        "siteID": "Site T111",
                        "sizeL": 4,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-26 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S112",
                        "shippedOnce": "No",
                        "siteID": "Site T112",
                        "sizeL": 8,
                        "storageTempC": 19,
                        "type": "pSludge",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                        "fieldSampleTempC": 16,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S113",
                        "shippedOnce": "Yes",
                        "siteID": "Site T113",
                        "sizeL": 10,
                        "storageTempC": 20,
                        "type": "swrSed",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule64",
    },
]

def test_method_64():
  assert create_dataset(rule_64) == output64

# Rule 65 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two values where the lower bound limit is infinity with (].

rule_65 = [{
        "ruleID": "rule65",
        "table": "Sample;WWMeasure",
        "variable": "value;dateTimeStart",
        "ruleValue": "(Inf,72000]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output65 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            }
        ],
        "rule_id": "rule65",
    },
]

def test_method_65():
  assert create_dataset(rule_65) == output65

# Rule 66 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two values where the upper bound limit is infinity with ().

rule_66 = [{
        "ruleID": "rule66",
        "table": "Sample;WWMeasure",
        "variable": "value;dateTimeStart",
        "ruleValue": "(98000, Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output66 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            }
        ],
        "rule_id": "rule66",
    },
]

def test_method_66():
  assert create_dataset(rule_66) == output66

# Rule 67 filters rows based on a single column from each table and single value from each column or any of the columns being an interval between 
# two values where the upper bound limit is infinity with [).

rule_67 = [{
        "ruleID": "rule67",
        "table": "Sample;WWMeasure",
        "variable": "value;dateTimeStart",
        "ruleValue": "[2021-02-01 21:00, Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]


output67 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S100",
                        "shippedOnce": "Yes",
                        "siteID": "Site T100",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S101",
                        "shippedOnce": "Yes",
                        "siteID": "Site T101",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S102",
                        "shippedOnce": "Yes",
                        "siteID": "Site T102",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S103",
                        "shippedOnce": "Yes",
                        "siteID": "Site T103",
                        "sizeL": 2,
                        "storageTempC": 25,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                        "fieldSampleTempC": 15,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S104",
                        "shippedOnce": "Yes",
                        "siteID": "Site T104",
                        "sizeL": 1,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-02-01 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                        "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                        "fieldSampleTempC": 17,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S105",
                        "shippedOnce": "Yes",
                        "siteID": "Site T105",
                        "sizeL": 2,
                        "storageTempC": 22,
                        "type": "rawWW",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule67",
    },
]

def test_method_67():
  assert create_dataset(rule_67) == output67

# Rule 68 filters rows based on a single column from each table and multiple values from each column or any of the columns where one value could be
# an interval and other a single value.

rule_68 = [{
        "ruleID": "rule68",
        "table": "Sample;WWMeasure",
        "variable": "value;dateTimeStart",
        "ruleValue": "[2021-02-01 21:00, 2021-02-03 21:00); 85000;(92000,145000); 2021-01-26 8:00",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output68 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule68",
    },
]

def test_method_68():
  assert create_dataset(rule_68) == output68

# For MULTIPLE TABLES:
## MULTIPLE COLUMNS FROM EACH TABLE OR ANY OF THE TABLES

# Rule 69 filters rows based on multiple columns and all values of the rows.

rule_69 = [{
        "ruleID": "rule69",
        "table": "Sample;WWMeasure",
        "variable": "value;dateTimeStart;analysisDate",
        "ruleValue": "ALL",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output69 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [],
        "WWMeasure": [],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule69",
    },
]

def test_method_69():
  assert create_dataset(rule_69) == output69

# Rule 70 filters rows based on multiple columns from each table and single value from each column or any of the columns being numeric.

rule_70 = [{
        "ruleID": "rule70",
        "table": "Sample;WWMeasure",
        "variable": "value;storageTempC;fieldSampleTempC",
        "ruleValue": "16.0;98000",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output70 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    }
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule70",
    },
]

def test_method_70():
  assert create_dataset(rule_70) == output70


# Rule 71 filters rows based on multiple columns from each table and single value from each column or any of the columns being string.

rule_71 = [{
        "ruleID": "rule71",
        "table": "Sample;WWMeasure",
        "variable": "unitOther; type; collection",
        "ruleValue": "rawWW; gcmcovn2",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output71 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule71",
    },
]

def test_method_71():
  assert create_dataset(rule_71) == output71

# Rule 72 filters rows based on multiple columns from each table and single value from each column or any of the columns being datetime.

rule_72 = [{
        "ruleID": "rule72",
        "table": "Sample;WWMeasure",
        "variable": "analysisDate; dateTimeStart; dateTimeEnd",
        "ruleValue": "2021-01-26 ; 2021-01-28 8:00",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output72 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    }
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule72",
    },
]

def test_method_72():
  assert create_dataset(rule_72) == output72

# Rule 73 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# numbers with [].

rule_73 = [{
        "ruleID": "rule73",
        "table": "Sample;WWMeasure",
        "variable": "value;storageTempC;fieldSampleTempC",
        "ruleValue": "[16.0; 17.0]; [98000,145000]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output73 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule73",
    },
]

def test_method_73():
  assert create_dataset(rule_73) == output73

# Rule 74 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# numbers with ().

rule_74 = [{
        "ruleID": "rule74",
        "table": "Sample;WWMeasure",
        "variable": "value;storageTempC;fieldSampleTempC",
        "ruleValue": "(15.0; 17.0); (85000,145000)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output74 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule74",
    },
]

def test_method_74():
  assert create_dataset(rule_74) == output74

# Rule 75 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# numbers with (].

rule_75 = [{
        "ruleID": "rule75",
        "table": "Sample;WWMeasure",
        "variable": "value;storageTempC;fieldSampleTempC",
        "ruleValue": "(15.0; 17.0]; (76000,145000]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output75 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule75",
    },
]

def test_method_75():
  assert create_dataset(rule_75) == output75

# Rule 76 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# numbers with [).

rule_76 = [{
        "ruleID": "rule76",
        "table": "Sample;WWMeasure",
        "variable": "value;storageTempC;fieldSampleTempC",
        "ruleValue": "[16.0; 17.0); [92000,145000)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output76 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule76",
    },
]

def test_method_76():
  assert create_dataset(rule_76) == output76

# Rule 77 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# datetime values with [].

rule_77 = [{
        "ruleID": "rule77",
        "table": "Sample;WWMeasure",
        "variable": "dateTimeStart;dateTimeEnd;analysisDate",
        "ruleValue": " [2021-01-27,2021-01-31]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output77 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule77",
    },
]

def test_method_77():
  assert create_dataset(rule_77) == output77

# Rule 78 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# datetime values with ().

rule_78 = [{
        "ruleID": "rule78",
        "table": "Sample;WWMeasure",
        "variable": "dateTimeStart;dateTimeEnd;analysisDate",
        "ruleValue": "( 2021-01-30 8:00 , 2021-02-02 21:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output78 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    }
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule78",
    },
]

def test_method_78():
  assert create_dataset(rule_78) == output78

# Rule 79 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# datetime values with (].

rule_79 = [{
        "ruleID": "rule79",
        "table": "Sample;WWMeasure",
        "variable": "dateTimeStart;dateTimeEnd;analysisDate",
        "ruleValue": "( 2021-01-30 8:00 , 2021-02-02 21:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output79 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule79",
    },
]

def test_method_79():
  assert create_dataset(rule_79) == output79

# Rule 80 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval between two
# datetime values with [).

rule_80 = [{
        "ruleID": "rule80",
        "table": "Sample;WWMeasure",
        "variable": "dateTimeStart;dateTimeEnd;analysisDate",
        "ruleValue": "[2021-02-01 21:00 , 2021-02-03 21:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output80 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    }
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule80",
    },
]

def test_method_80():
  assert create_dataset(rule_80) == output80

# Rule 81 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval where the 
# the lower bound limit is infinity with ().

rule_81 = [{
        "ruleID": "rule81",
        "table": "Sample;WWMeasure",
        "variable": "dateTimeStart;dateTimeEnd;analysisDate",
        "ruleValue": "(Inf, 2021-01-31)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output81 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule81",
    },
]

def test_method_81():
  assert create_dataset(rule_81) == output81

# Rule 82 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval where the 
# the lower bound limit is infinity with (].

rule_82 = [{
        "ruleID": "rule82",
        "table": "Sample;WWMeasure",
        "variable": "dateTimeStart;dateTimeEnd;analysisDate",
        "ruleValue": "(Inf , 2021-01-28 8:00]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output82 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule82",
    },
]

def test_method_82():
  assert create_dataset(rule_82) == output82

# Rule 83 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval where the 
# the upper bound limit is infinity with ().

rule_83 = [{
        "ruleID": "rule83",
        "table": "Sample;WWMeasure",
        "variable": "dateTimeStart;dateTimeEnd;analysisDate",
        "ruleValue": "(2021-02-25, Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output83 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                ],
                "table": "WWMeasure",
            }
        ],
        "rule_id": "rule83",
    },
]

def test_method_83():
  assert create_dataset(rule_83) == output83

# Rule 84 filters rows based on multiple columns from each table and single value from each column or any of the columns being an interval where the 
# the upper bound limit is infinity with [).

rule_84 = [{
        "ruleID": "rule84",
        "table": "Sample;WWMeasure",
        "variable": "dateTimeStart;dateTimeEnd;analysisDate",
        "ruleValue": "[2021-02-01 21:00, Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output84 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule84",
    },
]

def test_method_84():
  assert create_dataset(rule_84) == output84

# Rule 85 filters rows based on multiple columns from each table and multiple values from each column or any of the columns where one value could be an interval
# and the other could be a single value.

rule_85 = [{
        "ruleID": "rule85",
        "table": "Sample;WWMeasure",
        "variable": "dateTimeStart;value;analysisDate",
        "ruleValue": "( 2021-01-30 8:00 , 2021-02-03 21:00] ; 145000; [98000,145000]",
        "direction": "row",
        "sharedWith": "Public;PHAC" 
    }]

output85 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule85",
    },
]

def test_method_85():
  assert create_dataset(rule_85) == output85

# For MULTIPLE TABLES:
## ALL COLUMNS FROM EACH TABLE OR ANY OF THE TABLES

# Rule 86 filters rows based on all columns from each table and all values of the rows.

rule_86 = [{
        "ruleID": "rule86",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "ALL",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output86 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [],
        "WWMeasure": [],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule86",
    },
]

def test_method_86():
  assert create_dataset(rule_86) == output86

# Rule 87 filters rows based on all columns from each table and single value from each column or any of the columns being numeric.

rule_87 = [{
        "ruleID": "rule87",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "17.0;98000",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output87 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    }
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule87",
    },
]

def test_method_87():
  assert create_dataset(rule_87) == output87

# Rule 88 filters rows based on all columns from each table and single value from each column or any of the columns being string.

rule_88 = [{
        "ruleID": "rule88",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "gcmnPMMoV; pSludge; grb;gcM",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output88 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y101",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN201",
                        "labID": "Lab L101",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-09 00:00:00"),
                        "reporterID": "Reporter R2",
                        "sampleID": "Sample S101",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW101",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule88",
    },
]

def test_method_88():
  assert create_dataset(rule_88) == output88

# Rule 89 filters rows based on all columns from each table and single value from each column or any of the columns being datetime.

rule_89 = [{
        "ruleID": "rule89",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "2021-02-01 21:00; 2021-01-31",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output89 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    }
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule89",
    },
]

def test_method_89():
  assert create_dataset(rule_89) == output89

# Rule 90 filters rows based on all columns from each table and single value from each column or any of the columns being an interval between two numbers
# with [].

rule_90 = [{
        "ruleID": "rule90",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "[8.0,10.0];[16.0,17.0],[76000,102000]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output90 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule90",
    },
]

def test_method_90():
  assert create_dataset(rule_90) == output90

# Rule 91 filters rows based on all columns from each table and single value from each column or any of the columns being an interval between two numbers
# with ().

rule_91 = [{
        "ruleID": "rule91",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "(2.0,10.0);(15.0,17.0),(98000,145000)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output91 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    }
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule91",
    },
]

def test_method_91():
  assert create_dataset(rule_91) == output91

# Rule 92 filters rows based on all columns from each table and single value from each column or any of the columns being an interval between two numbers
# with (].

rule_92 = [{
        "ruleID": "rule92",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "(2.0,10.0];(15.0,18.0],(98000,145000]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output92 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            }
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule92",
    },
]

def test_method_92():
  assert create_dataset(rule_92) == output92

# Rule 93 filters rows based on all columns from each table and single value from each column or any of the columns being an interval between two numbers
# with [).

rule_93 = [{
        "ruleID": "rule93",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "[8.0,10.0);[16.0,18.0),[98000,102000)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output93 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    }
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    }
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule93",
    },
]

def test_method_93():
  assert create_dataset(rule_93) == output93

# Rule 94 filters rows based on all columns from each table and single value from each column or any of the columns being an interval between two datetime
# with [].

rule_94 = [{
        "ruleID": "rule94",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "[2021-01-26,2021-01-31]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output94 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule94",
    },
]

def test_method_94():
  assert create_dataset(rule_94) == output94

# Rule 95 filters rows based on all columns from each table and single value from each column or any of the columns being an interval between two datetime
# with ().

rule_95 = [{
        "ruleID": "rule95",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "(2021-01-27 8:00, 2021-02-01 21:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output95 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-28 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                        "fieldSampleTempC": 18,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S107",
                        "shippedOnce": "Yes",
                        "siteID": "Site T107",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "grb",
                        "dateTime": Timestamp("2021-01-29 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                        "fieldSampleTempC": 14,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S109",
                        "shippedOnce": "Yes",
                        "siteID": "Site T109",
                        "sizeL": 2,
                        "storageTempC": 16,
                        "type": "rawWW",
                    },
                    {
                        "collection": "cpTP24h",
                        "dateTime": Timestamp("2021-01-31 21:00:00"),
                        "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                        "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                        "fieldSampleTempC": 13,
                        "notes": "Samples shipped on ice from site to lab by courier",
                        "sampleID": "Sample S110",
                        "shippedOnce": "Yes",
                        "siteID": "Site T110",
                        "sizeL": 3,
                        "storageTempC": 17,
                        "type": "water",
                    },
                ],
                "table": "Sample",
            }
        ],
        "rule_id": "rule95",
    },
]

def test_method_95():
  assert create_dataset(rule_95) == output95

# Rule 96 filters rows based on all columns from each table and single value from each column or any of the columns being an interval between two datetime
# with [).

rule_96 = [{
        "ruleID": "rule96",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "[2021-01-27 8:00, 2021-02-01 21:00)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output96 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule96",
    },
]

def test_method_96():
  assert create_dataset(rule_96) == output96

# Rule 97 filters rows based on all columns from each table and single value from each column or any of the columns being an interval between two datetime
# with (].

rule_97 = [{
        "ruleID": "rule97",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "(2021-01-26,2021-02-02];",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output97 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 16000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-27 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 17000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-25 00:00:00"),
                        "assayID": "Assay Y102",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN202",
                        "labID": "Lab L102",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-30 00:00:00"),
                        "reporterID": "Reporter R3",
                        "sampleID": "Sample S102",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW102",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule97",
    },
]

def test_method_97():
  assert create_dataset(rule_97) == output97

# Rule 98 filters rows based on all columns from each table and single value from each column or any of the columns being an interval where the 
# the lower bound limit is infinity with ().

rule_98 = [{
        "ruleID": "rule98",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "(Inf , 2.0)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output98 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y104",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN204",
                "labID": "Lab L104",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R5",
                "sampleID": "Sample S104",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW104",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 102000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule98",
    },
]

def test_method_98():
  assert create_dataset(rule_98) == output98

# Rule 99 filters rows based on all columns from each table and single value from each column or any of the columns being an interval where the 
# the lower bound limit is infinity with (].

rule_99 = [{
        "ruleID": "rule99",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "(Inf , 4.0]",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output99 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-26 00:00:00"),
                "assayID": "Assay Y105",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN205",
                "labID": "Lab L105",
                "notes": "nPMMoV measure linked to CovidN2 by index6",
                "reportDate": Timestamp("2021-01-31 00:00:00"),
                "reporterID": "Reporter R6",
                "sampleID": "Sample S105",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW105",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 145000,
            },
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y107",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN207",
                "labID": "Lab L107",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R8",
                "sampleID": "Sample S107",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW107",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 98000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcM",
                        "unitOther": "gcMcovN1",
                        "value": 20000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 22000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN1 replicate measures linked by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN1",
                        "value": 23000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-25 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "CovidN2 replicate measures linked by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "covN2",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcMcovN2",
                        "value": 15000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-07 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 3,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-28 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 85000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-26 00:00:00"),
                        "assayID": "Assay Y103",
                        "fractionAnalyzed": "liquid",
                        "index": 2,
                        "instrumentID": "Instrument IN203",
                        "labID": "Lab L103",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R4",
                        "sampleID": "Sample S103",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW103",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 92000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-25 00:00:00"),
                        "assayID": "Assay Y106",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN206",
                        "labID": "Lab L106",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-25 00:00:00"),
                        "reporterID": "Reporter R7",
                        "sampleID": "Sample S106",
                        "type": "nPMMoV1",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW106",
                        "unit": "gcM",
                        "unitOther": "gcmnPMMoV1",
                        "value": 89000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule99",
    },
]

def test_method_99():
  assert create_dataset(rule_99) == output99

# Rule 100 filters rows based on all columns from each table and single value from each column or any of the columns being an interval where the 
# the upper bound limit is infinity with ().

rule_100 = [{
        "ruleID": "rule100",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "(92000,Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output100 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            }
        ],
        "rule_id": "rule100",
    },
]

def test_method_100():
  assert create_dataset(rule_100) == output100

# Rule 101 filters rows based on all columns from each table and single value from each column or any of the columns being an interval where the 
# the upper bound limit is infinity with [).

rule_101 = [{
        "ruleID": "rule101",
        "table": "Sample;WWMeasure",
        "variable": "ALL",
        "ruleValue": "[98000,Inf)",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output101 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S100",
                "shippedOnce": "Yes",
                "siteID": "Site T100",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S101",
                "shippedOnce": "Yes",
                "siteID": "Site T101",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-01 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S102",
                "shippedOnce": "Yes",
                "siteID": "Site T102",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-04 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-03 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S103",
                "shippedOnce": "Yes",
                "siteID": "Site T103",
                "sizeL": 2,
                "storageTempC": 25,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-03 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-02 21:00:00"),
                "fieldSampleTempC": 15,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S104",
                "shippedOnce": "Yes",
                "siteID": "Site T104",
                "sizeL": 1,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-02-02 21:00:00"),
                "dateTimeStart": Timestamp("2021-02-01 21:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S105",
                "shippedOnce": "Yes",
                "siteID": "Site T105",
                "sizeL": 2,
                "storageTempC": 22,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-31 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-30 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-30 08:00:00"),
                "fieldSampleTempC": 13,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S110",
                "shippedOnce": "Yes",
                "siteID": "Site T110",
                "sizeL": 3,
                "storageTempC": 17,
                "type": "water",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-01 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S113",
                "shippedOnce": "Yes",
                "siteID": "Site T113",
                "sizeL": 10,
                "storageTempC": 20,
                "type": "swrSed",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-01-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-03-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 80000,
            },
            {
                "analysisDate": Timestamp("2021-03-06 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 82000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-01-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 75000,
            },
            {
                "analysisDate": Timestamp("2021-02-09 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-02 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 76000,
            },
            {
                "analysisDate": Timestamp("2021-02-02 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            }
        ],
        "rule_id": "rule101",
    },
]

def test_method_101():
  assert create_dataset(rule_101) == output101

# Rule 102 filters rows based on all columns from each table and multiple values from each column or any of the columns where one value could be an interval
# and the other could be a single value.

rule_102 = [{
        "ruleID": "rule102",
        "table": "Sample;WWMeasure",
        "variable": "dateTimeStart;value;analysisDate",
        "ruleValue": "( 2021-01-30 8:00 , 2021-02-03 21:00] ; 145000;[98000,145000]; 2021-03-06",
        "direction": "row",
        "sharedWith": "Public;PHAC"
    }]

output102 = [
    {
        "AssayMethod": [
            {
                "assayMethodID": "Assay Y100",
                "date": Timestamp("2021-01-28 00:00:00"),
                "instrumentID": "Instrument IN200",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y101",
                "date": Timestamp("2021-01-29 00:00:00"),
                "instrumentID": "Instrument IN201",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y102",
                "date": Timestamp("2021-01-30 00:00:00"),
                "instrumentID": "Instrument IN202",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y103",
                "date": Timestamp("2021-01-31 00:00:00"),
                "instrumentID": "Instrument IN203",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.001,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y104",
                "date": Timestamp("2021-02-01 00:00:00"),
                "instrumentID": "Instrument IN204",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.003,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
            {
                "assayMethodID": "Assay Y105",
                "date": Timestamp("2021-02-02 00:00:00"),
                "instrumentID": "Instrument IN205",
                "lod": 10,
                "loq": 30,
                "name": "Assay Method Name",
                "referenceLink": "A link to the pdf version of the SOP",
                "sampleSizeL": 0.002,
                "summary": "Short summary assay method description",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "version": "Assay Method Version",
            },
        ],
        "Sample": [
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-25 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-24 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-24 08:00:00"),
                "fieldSampleTempC": 17,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S106",
                "shippedOnce": "Yes",
                "siteID": "Site T106",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-28 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-27 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-27 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S107",
                "shippedOnce": "Yes",
                "siteID": "Site T107",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-01-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-25 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-25 08:00:00"),
                "fieldSampleTempC": 18,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S108",
                "shippedOnce": "Yes",
                "siteID": "Site T108",
                "sizeL": 2,
                "storageTempC": 18,
                "type": "rawWW",
            },
            {
                "collection": "grb",
                "dateTime": Timestamp("2021-01-29 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-28 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-28 08:00:00"),
                "fieldSampleTempC": 14,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S109",
                "shippedOnce": "Yes",
                "siteID": "Site T109",
                "sizeL": 2,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "mooreSw",
                "dateTime": Timestamp("2021-02-27 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 12,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S111",
                "shippedOnce": "Yes",
                "siteID": "Site T111",
                "sizeL": 4,
                "storageTempC": 16,
                "type": "rawWW",
            },
            {
                "collection": "cpTP24h",
                "dateTime": Timestamp("2021-02-26 21:00:00"),
                "dateTimeEnd": Timestamp("2021-01-26 08:00:00"),
                "dateTimeStart": Timestamp("2021-01-26 08:00:00"),
                "fieldSampleTempC": 16,
                "notes": "Samples shipped on ice from site to lab by courier",
                "sampleID": "Sample S112",
                "shippedOnce": "No",
                "siteID": "Site T112",
                "sizeL": 8,
                "storageTempC": 19,
                "type": "pSludge",
            },
        ],
        "WWMeasure": [
            {
                "analysisDate": Timestamp("2021-02-08 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 1,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcM",
                "unitOther": "gcMcovN1",
                "value": 20000,
            },
            {
                "analysisDate": Timestamp("2021-03-31 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 22000,
            },
            {
                "analysisDate": Timestamp("2021-03-29 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN1 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN1",
                "value": 23000,
            },
            {
                "analysisDate": Timestamp("2021-01-25 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 4,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-02-06 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 15000,
            },
            {
                "analysisDate": Timestamp("2021-01-28 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 5,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 16000,
            },
            {
                "analysisDate": Timestamp("2021-01-27 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "CovidN2 replicate measures linked by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "covN2",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcMcovN2",
                "value": 17000,
            },
            {
                "analysisDate": Timestamp("2021-02-07 00:00:00"),
                "assayID": "Assay Y100",
                "fractionAnalyzed": "solid",
                "index": 3,
                "instrumentID": "Instrument IN200",
                "labID": "Lab L100",
                "notes": "nPMMoV measure linked to CovidN1 by index",
                "reportDate": Timestamp("2021-01-28 00:00:00"),
                "reporterID": "Reporter R1",
                "sampleID": "Sample S100",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW100",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 85000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y101",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN201",
                "labID": "Lab L101",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-02-09 00:00:00"),
                "reporterID": "Reporter R2",
                "sampleID": "Sample S101",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW101",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-03-25 00:00:00"),
                "assayID": "Assay Y102",
                "fractionAnalyzed": "solid",
                "index": 6,
                "instrumentID": "Instrument IN202",
                "labID": "Lab L102",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-30 00:00:00"),
                "reporterID": "Reporter R3",
                "sampleID": "Sample S102",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW102",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 72000,
            },
            {
                "analysisDate": Timestamp("2021-01-26 00:00:00"),
                "assayID": "Assay Y103",
                "fractionAnalyzed": "liquid",
                "index": 2,
                "instrumentID": "Instrument IN203",
                "labID": "Lab L103",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-26 00:00:00"),
                "reporterID": "Reporter R4",
                "sampleID": "Sample S103",
                "type": "nPMMoV",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW103",
                "unit": "gcMl",
                "unitOther": "gcmnPMMoV",
                "value": 92000,
            },
            {
                "analysisDate": Timestamp("2021-02-25 00:00:00"),
                "assayID": "Assay Y106",
                "fractionAnalyzed": "solid",
                "index": 2,
                "instrumentID": "Instrument IN206",
                "labID": "Lab L106",
                "notes": "nPMMoV measure linked to CovidN2 by index",
                "reportDate": Timestamp("2021-01-25 00:00:00"),
                "reporterID": "Reporter R7",
                "sampleID": "Sample S106",
                "type": "nPMMoV1",
                "typeOther": np.nan,
                "uWwMeasureID": "Measure WW106",
                "unit": "gcM",
                "unitOther": "gcmnPMMoV1",
                "value": 89000,
            },
        ],
    },
    {
        "entities_filtered": [
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
            {
                "rows_removed": [
                    {
                        "analysisDate": Timestamp("2021-01-29 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-03-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 80000,
                    },
                    {
                        "analysisDate": Timestamp("2021-03-06 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN1 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 82000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-31 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 4,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 75000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-09 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 5,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-02 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 76000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-02 00:00:00"),
                        "assayID": "Assay Y100",
                        "fractionAnalyzed": "solid",
                        "index": 1,
                        "instrumentID": "Instrument IN200",
                        "labID": "Lab L100",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-02-06 00:00:00"),
                        "reporterID": "Reporter R1",
                        "sampleID": "Sample S100",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW100",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 72000,
                    },
                    {
                        "analysisDate": Timestamp("2021-01-28 00:00:00"),
                        "assayID": "Assay Y104",
                        "fractionAnalyzed": "solid",
                        "index": 2,
                        "instrumentID": "Instrument IN204",
                        "labID": "Lab L104",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R5",
                        "sampleID": "Sample S104",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW104",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 102000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-26 00:00:00"),
                        "assayID": "Assay Y105",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN205",
                        "labID": "Lab L105",
                        "notes": "nPMMoV measure linked to CovidN2 by index6",
                        "reportDate": Timestamp("2021-01-31 00:00:00"),
                        "reporterID": "Reporter R6",
                        "sampleID": "Sample S105",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW105",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 145000,
                    },
                    {
                        "analysisDate": Timestamp("2021-02-08 00:00:00"),
                        "assayID": "Assay Y107",
                        "fractionAnalyzed": "solid",
                        "index": 6,
                        "instrumentID": "Instrument IN207",
                        "labID": "Lab L107",
                        "notes": "nPMMoV measure linked to CovidN2 by index",
                        "reportDate": Timestamp("2021-01-26 00:00:00"),
                        "reporterID": "Reporter R8",
                        "sampleID": "Sample S107",
                        "type": "nPMMoV",
                        "typeOther": np.nan,
                        "uWwMeasureID": "Measure WW107",
                        "unit": "gcMl",
                        "unitOther": "gcmnPMMoV",
                        "value": 98000,
                    },
                ],
                "table": "WWMeasure",
            },
        ],
        "rule_id": "rule102",
    },
]

def test_method_102():
  assert create_dataset(rule_102) == output102